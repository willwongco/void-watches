{% doc %}
  @prompt
    Generate a grid of thumbnails showing all SKUs in the displayed collection. The thumbnail size should be adjustable from 50px to 120px., The thumbnails are not showing., REmove all text. Thumbnails should be square., Remove border, make thumbnails square., Make padding between thumbnails smaller., Make it possible to define alignment of the grid. Right, left or centered.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-sku-grid-{{ ai_gen_id }} {
    width: 100%;
    padding: {{ block.settings.section_padding }}px 0;
    {% if block.settings.grid_alignment == 'left' %}
      text-align: left;
    {% elsif block.settings.grid_alignment == 'right' %}
      text-align: right;
    {% else %}
      text-align: center;
    {% endif %}
  }

  .ai-sku-grid-container-{{ ai_gen_id }} {
    display: inline-grid;
    grid-template-columns: repeat(auto-fill, minmax({{ block.settings.thumbnail_size }}px, 1fr));
    gap: {{ block.settings.grid_gap }}px;
    {% if block.settings.grid_alignment == 'left' %}
      justify-self: start;
    {% elsif block.settings.grid_alignment == 'right' %}
      justify-self: end;
    {% else %}
      justify-self: center;
    {% endif %}
  }

  .ai-sku-grid-item-{{ ai_gen_id }} {
    position: relative;
    display: block;
    background-color: {{ block.settings.item_background_color }};
    padding: {{ block.settings.item_padding }}px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    text-decoration: none;
  }

  .ai-sku-grid-item-{{ ai_gen_id }}:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .ai-sku-grid-image-{{ ai_gen_id }} {
    width: {{ block.settings.thumbnail_size }}px;
    height: {{ block.settings.thumbnail_size }}px;
    object-fit: cover;
    display: block;
  }

  .ai-sku-grid-image-placeholder-{{ ai_gen_id }} {
    width: {{ block.settings.thumbnail_size }}px;
    height: {{ block.settings.thumbnail_size }}px;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-sku-grid-image-placeholder-{{ ai_gen_id }} svg {
    width: 50%;
    height: 50%;
    opacity: 0.3;
  }

  .ai-sku-grid-empty-{{ ai_gen_id }} {
    text-align: center;
    padding: 40px 20px;
    color: #666;
    font-size: 16px;
  }

  @media screen and (max-width: 749px) {
    .ai-sku-grid-container-{{ ai_gen_id }} {
      grid-template-columns: repeat(auto-fill, minmax({{ block.settings.thumbnail_size | times: 0.8 }}px, 1fr));
      gap: {{ block.settings.grid_gap | times: 0.8 }}px;
    }

    .ai-sku-grid-image-{{ ai_gen_id }},
    .ai-sku-grid-image-placeholder-{{ ai_gen_id }} {
      width: {{ block.settings.thumbnail_size | times: 0.8 }}px;
      height: {{ block.settings.thumbnail_size | times: 0.8 }}px;
    }

    .ai-sku-grid-item-{{ ai_gen_id }} {
      padding: {{ block.settings.item_padding | times: 0.8 }}px;
    }
  }
{% endstyle %}

<div class="ai-sku-grid-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  {% if block.settings.collection != blank %}
    {% assign collection = block.settings.collection %}
    {% assign variant_count = 0 %}
    
    {% for product in collection.products %}
      {% assign variant_count = variant_count | plus: product.variants.size %}
    {% endfor %}

    {% if variant_count > 0 %}
      <div class="ai-sku-grid-container-{{ ai_gen_id }}">
        {% for product in collection.products %}
          {% for variant in product.variants %}
            <a href="{{ variant.url }}" class="ai-sku-grid-item-{{ ai_gen_id }}">
              {% if variant.image %}
                <img
                  src="{{ variant.image | image_url: width: 200 }}"
                  alt="{{ variant.image.alt | escape }}"
                  class="ai-sku-grid-image-{{ ai_gen_id }}"
                  loading="lazy"
                  width="200"
                  height="200"
                >
              {% elsif product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 200 }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  class="ai-sku-grid-image-{{ ai_gen_id }}"
                  loading="lazy"
                  width="200"
                  height="200"
                >
              {% else %}
                <div class="ai-sku-grid-image-placeholder-{{ ai_gen_id }}">
                  {{ 'product-apparel-1' | placeholder_svg_tag }}
                </div>
              {% endif %}
            </a>
          {% endfor %}
        {% endfor %}
      </div>
    {% else %}
      <div class="ai-sku-grid-empty-{{ ai_gen_id }}">
        No products found in this collection.
      </div>
    {% endif %}
  {% else %}
    <div class="ai-sku-grid-empty-{{ ai_gen_id }}">
      Please select a collection to display SKUs.
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "Collection SKU grid",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "grid_alignment",
      "label": "Grid alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "thumbnail_size",
      "min": 50,
      "max": 120,
      "step": 5,
      "unit": "px",
      "label": "Thumbnail size",
      "default": 80
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Grid gap",
      "default": 4
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Section padding",
      "default": 20
    },
    {
      "type": "header",
      "content": "Item style"
    },
    {
      "type": "color",
      "id": "item_background_color",
      "label": "Item background",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "item_padding",
      "min": 0,
      "max": 15,
      "step": 1,
      "unit": "px",
      "label": "Item padding",
      "default": 2
    }
  ],
  "presets": [
    {
      "name": "Collection SKU grid"
    }
  ]
}
{% endschema %}