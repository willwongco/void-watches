{%- assign variant = product.selected_or_first_available_variant -%}

{%- comment -%} Top-right badge: Sold Out > Metafield > Sale {%- endcomment -%}
<div class="product-badges product-badges--top-right">
  {%- if product.available == false -%}
    <div class="product-badges__badge product-badges__badge--rectangle">
      {{ 'content.product_badge_sold_out' | t }}
    </div>
  {%- elsif product.metafields.custom.sale_percentage != blank -%}
    <div class="product-badges__badge product-badges__badge--rectangle">
      {{ product.metafields.custom.sale_percentage }}
    </div>
  {%- elsif product.compare_at_price > product.price -%}
    <div class="product-badges__badge product-badges__badge--rectangle">
      {{ 'content.product_badge_sale' | t }}
    </div>
  {%- endif -%}
</div>

{%- comment -%} Top-left badge: Low-stock badge (transparent background) {%- endcomment -%}
{%- if variant.available and variant.inventory_quantity <= 5 and variant.inventory_quantity > 0 -%}
  <div class="product-badges product-badges--top-left">
    <div class="product-badges__badge product-badges__badge--rectangle product-badges__badge--transparent">
      ONLY {{ variant.inventory_quantity }} LEFT
    </div>
  </div>
{%- endif -%}

{% stylesheet %}
.product-badges {
  position: absolute;
  z-index: 10;
}

.product-badges--top-right {
  top: 20px;   /* top offset from image edge */
  right: 8px;
}

.product-badges--top-left {
  top: 20px;   /* default top offset from image edge */
  left: 8px;   /* default left offset from image edge */
}

.product-badges__badge {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: var(--color-foreground);
  background: var(--color-background);
  font-size: var(--font-size--xs);
  font-family: var(--font-body--family);
  font-weight: var(--font-body--weight);
  text-transform: uppercase;
  border-radius: var(--badge-border-radius);
}

.product-badges__badge--rectangle {
  padding-block: 4px;   /* vertical padding inside badge */
  padding-inline: 8px;  /* horizontal padding inside badge */
}

/* Transparent badge for low-stock */
.product-badges__badge--transparent {
  background: transparent;
  color: var(--color-foreground); /* keeps text visible */
}

/* Mobile adjustments */
@media screen and (max-width: 480px) {
  .product-badges--top-left {
    top: 8px;   /* top padding equal to left padding */
    left: 8px;  /* left padding equal to top padding */
  }

  .product-badges--top-left .product-badges__badge {
    font-size: 0.7rem;  /* smaller text for mobile */
    padding-block: 2px; /* reduced vertical padding for compactness */
  }
}
{% endstylesheet %}
